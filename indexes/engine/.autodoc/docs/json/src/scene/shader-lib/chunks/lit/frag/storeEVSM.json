{
  "fileName": "storeEVSM.js",
  "filePath": "src/scene/shader-lib/chunks/lit/frag/storeEVSM.js",
  "url": "https://github.com/playcanvas/engine/src/scene/shader-lib/chunks/lit/frag/storeEVSM.js",
  "summary": "This code is a shader program written in GLSL (OpenGL Shading Language) that is used for rendering shadows in the PlayCanvas engine. The shader takes in a depth value and applies a technique called Variance Shadow Mapping (VSM) to create soft shadows.\n\nThe first line of the code initializes a variable called \"exponent\" with a value of VSM_EXPONENT. This value is used to control the softness of the shadows.\n\nThe next two lines of code manipulate the depth value by scaling it from the range of [0,1] to [-1,1] and then applying an exponential function to it. This is done to improve the accuracy of the shadow map and reduce the occurrence of shadow acne (artifacts that occur when the depth values are too close together).\n\nFinally, the resulting depth value is used to calculate the final color of the pixel. The color is a combination of the depth value, the depth squared, and a constant value of 1 for the alpha channel. This creates a smooth gradient of shadow intensity that can be used to render realistic shadows in the game.\n\nThis shader program is likely used in conjunction with other rendering techniques to create a complete shadow rendering system in the PlayCanvas engine. It can be applied to any object in the game that needs to cast or receive shadows, and can be customized by adjusting the value of the \"exponent\" variable to achieve the desired level of softness. \n\nExample usage:\n\n```javascript\n// create a material with the VSM shadow shader\nvar shadowMaterial = new pc.StandardMaterial();\nshadowMaterial.chunks.shadow = PlayCanvasVSMShader;\n\n// apply the material to an object that needs to cast shadows\nvar shadowCaster = new pc.Entity();\nshadowCaster.addComponent(\"model\", {\n    type: \"box\"\n});\nshadowCaster.model.material = shadowMaterial;\nshadowCaster.setLocalPosition(0, 1, 0);\n\n// apply the material to an object that receives shadows\nvar shadowReceiver = new pc.Entity();\nshadowReceiver.addComponent(\"model\", {\n    type: \"plane\"\n});\nshadowReceiver.model.material = shadowMaterial;\nshadowReceiver.setLocalPosition(0, 0, 0);\n```",
  "questions": "1. **What is the purpose of the `VSM_EXPONENT` variable?** \nThe `VSM_EXPONENT` variable is used to control the exponent value in the depth calculation.\n\n2. **What is the expected input for the `depth` variable?** \nThe `depth` variable is expected to be a value between 0 and 1, representing the depth of a pixel in the scene.\n\n3. **What is the output of this code?** \nThe output of this code is a `vec4` color value, with the first component representing the depth value, the second component representing the depth squared, and the last two components set to 1.0."
}