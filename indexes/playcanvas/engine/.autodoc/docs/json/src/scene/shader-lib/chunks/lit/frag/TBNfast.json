{
  "fileName": "TBNfast.js",
  "filePath": "src/scene/shader-lib/chunks/lit/frag/TBNfast.js",
  "url": "https://github.com/playcanvas/engine/src/scene/shader-lib/chunks/lit/frag/TBNfast.js",
  "summary": "The code above is a GLSL shader function that calculates the TBN matrix (tangent, binormal, normal) for a given set of vertex attributes. The TBN matrix is used in 3D graphics to transform normal vectors from object space to tangent space, which is necessary for certain lighting and shading techniques.\n\nThe function takes in three vec3 parameters: tangent, binormal, and normal. These vectors represent the tangent, binormal, and normal vectors of a vertex in object space. The function then constructs a 3x3 matrix called dTBN using these vectors. This matrix is the TBN matrix for the vertex.\n\nThe TBN matrix is used in various lighting and shading techniques, such as normal mapping and parallax mapping. These techniques require the normal vectors of a mesh to be transformed from object space to tangent space, so that they can be used to calculate lighting and shading effects that are dependent on the orientation of the surface.\n\nHere is an example of how this function might be used in a larger project:\n\n```glsl\n// Vertex shader\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec2 a_uv;\nattribute vec3 a_tangent;\nattribute vec3 a_binormal;\n\nuniform mat4 u_modelMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\n\nvarying vec2 v_uv;\nvarying vec3 v_tangent;\nvarying vec3 v_binormal;\nvarying vec3 v_normal;\n\nvoid main() {\n    // Transform vertex attributes to world space\n    vec4 worldPosition = u_modelMatrix * vec4(a_position, 1.0);\n    vec3 worldNormal = normalize(mat3(u_modelMatrix) * a_normal);\n    vec3 worldTangent = normalize(mat3(u_modelMatrix) * a_tangent);\n    vec3 worldBinormal = normalize(mat3(u_modelMatrix) * a_binormal);\n\n    // Transform vertex attributes to view space\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    vec3 viewNormal = normalize(mat3(u_viewMatrix) * worldNormal);\n    vec3 viewTangent = normalize(mat3(u_viewMatrix) * worldTangent);\n    vec3 viewBinormal = normalize(mat3(u_viewMatrix) * worldBinormal);\n\n    // Calculate TBN matrix\n    getTBN(viewTangent, viewBinormal, viewNormal);\n\n    // Pass vertex attributes to fragment shader\n    v_uv = a_uv;\n    v_tangent = viewTangent;\n    v_binormal = viewBinormal;\n    v_normal = viewNormal;\n\n    // Transform vertex position to clip space\n    gl_Position = u_projectionMatrix * viewPosition;\n}\n```\n\nIn this example, the vertex shader takes in various vertex attributes, including the tangent, binormal, and normal vectors. It then transforms these attributes to world space and view space, and calculates the TBN matrix using the getTBN function. The TBN matrix is then passed to the fragment shader, where it is used to transform normal vectors from object space to tangent space for lighting and shading calculations.\n\nOverall, the getTBN function is a crucial part of many advanced lighting and shading techniques in 3D graphics, and is used extensively in the PlayCanvas engine.",
  "questions": "1. What does the `/* glsl */` comment indicate in the code?\n   - The `/* glsl */` comment indicates that the code is written in GLSL (OpenGL Shading Language), which is a high-level shading language used for graphics programming.\n\n2. What is the purpose of the `getTBN` function?\n   - The `getTBN` function is used to calculate the TBN (tangent, binormal, normal) matrix from the given tangent, binormal, and normal vectors.\n\n3. What is the data type of the `dTBN` variable?\n   - The data type of the `dTBN` variable is not specified in the code snippet, so it is unclear what type it is. It could be a global variable or a parameter passed in from another function."
}